##price_board definition :
create table public.price_board (
  product_id integer not null,
  price numeric null,
  effective_date date not null default CURRENT_DATE,
  min_price numeric null,
  constraint price_board_pkey primary key (product_id, effective_date)
) TABLESPACE pg_default;

create trigger before_insert_price_board BEFORE INSERT on price_board for EACH row
execute FUNCTION set_min_price ();

##products definition :
create table public.products (
  id integer generated by default as identity not null,
  name text null,
  default_unit text null,
  aliases text[] null,
  brand text null,
  constraint products_pkey primary key (id)
) TABLESPACE pg_default;

create index IF not exists products_aliases_idx on public.products using gin (aliases) TABLESPACE pg_default;

##slip_items definition:
create table public.slip_items (
  id serial not null,
  slip_id uuid null,
  product_id integer null,
  qty numeric null,
  unit text null,
  rate numeric null,
  line_total numeric null,
  slip_timestamp timestamp with time zone null default now(),
  constraint slip_items_pkey primary key (id),
  constraint slip_items_slip_id_fkey foreign KEY (slip_id) references slips (id) on delete CASCADE
) TABLESPACE pg_default;

##slips defition :
create table public.slips (
  id uuid not null default gen_random_uuid (),
  slip_no integer generated always as identity not null,
  slip_date date null default CURRENT_DATE,
  shop_id integer null,
  customer_name text null,
  gst_required boolean null default false,
  subtotal numeric null,
  discount numeric null,
  total numeric null,
  slip_timestamp timestamp with time zone null default now(),
  constraint slips_pkey primary key (id)
) TABLESPACE pg_default;

create index IF not exists slips_slip_date_idx on public.slips using btree (slip_date) TABLESPACE pg_default;

create index IF not exists slips_shop_id_slip_date_idx on public.slips using btree (shop_id, slip_date) TABLESPACE pg_default;